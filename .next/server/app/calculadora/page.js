(()=>{var e={};e.id=281,e.ids=[281],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8805:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>c}),t(1676),t(1506),t(5866);var s=t(3191),r=t(8716),l=t(7922),o=t.n(l),n=t(5231),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);t.d(a,i);let c=["",{children:["calculadora",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,1676)),"D:\\Transelca - Martin Pinedo\\Proyecto-Desglose-de-Torres\\app\\calculadora\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"D:\\Transelca - Martin Pinedo\\Proyecto-Desglose-de-Torres\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\Transelca - Martin Pinedo\\Proyecto-Desglose-de-Torres\\app\\calculadora\\page.tsx"],p="/calculadora/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/calculadora/page",pathname:"/calculadora",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5691:(e,a,t)=>{Promise.resolve().then(t.bind(t,1717))},4210:()=>{},9096:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},1717:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>o});var s=t(326),r=t(7577),l=t(434);function o(){let[e,a]=(0,r.useState)({tipo:"",fabricante:"",cabeza:""}),[t,o]=(0,r.useState)({TIPO:[],FABRICANTE:[],CABEZA:[],PARTE_DIVISION:[]}),[c,d]=(0,r.useState)({}),[p,x]=(0,r.useState)([]),[u,m]=(0,r.useState)({total_pieces:0,total_weight:0}),[h,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(""),[j,v]=(0,r.useState)("Selecciona TIPO y FABRICANTE para ver las partes disponibles..."),N=async()=>{try{let a=new URLSearchParams;e.tipo&&a.append("TIPO",e.tipo),e.fabricante&&a.append("FABRICANTE",e.fabricante),e.cabeza&&a.append("CABEZA",e.cabeza);let t=await fetch(`/api/options?${a}`),s=await t.json();if(s.success&&(o(s.options),e.tipo&&e.fabricante&&s.options.PARTE_DIVISION)){let e={};s.options.PARTE_DIVISION.forEach(a=>{e[a]={part:a,quantity:1,selected:!1}}),d(e)}}catch(e){console.error("Error loading options:",e)}},y=(e,t)=>{a(a=>({...a,[e]:t})),setTimeout(()=>N(),0)},P=e=>{d(a=>({...a,[e]:{...a[e],selected:!a[e].selected}}))},C=(e,a)=>{d(t=>({...t,[e]:{...t[e],quantity:Math.max(1,a)}}))},D=async()=>{let a=Object.values(c).filter(e=>e.selected);if(0===a.length){_("âš ï¸ Por favor selecciona al menos una parte de la torre");return}if(!e.tipo||!e.fabricante){_("âš ï¸ Por favor completa al menos TIPO Y FABRICANTE");return}b(!0),f("â³ Calculando materiales...");try{let t=await fetch("/api/calculate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filters:e,parts:a.map(e=>({part:e.part,quantity:e.quantity}))})}),s=await t.json();s.success?(x(s.results),m(s.totals),f(`âœ… ${s.results.length} piezas diferentes encontradas`)):f(`âŒ Error: ${s.message}`)}catch(e){f(`ðŸš¨ Error: ${e instanceof Error?e.message:"Error desconocido"}`)}},_=e=>{alert(e)};return s.jsx("div",{className:"min-h-screen p-5",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,s.jsxs)("div",{className:"max-w-[1600px] mx-auto bg-white p-8 rounded-xl shadow-2xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-[#2c3e50] mb-2",children:"\uD83D\uDD27 Calculadora de Materiales - Torres"}),s.jsx("p",{className:"text-[#7f8c8d] text-sm",children:"Selecciona las partes de la torre que necesitas y calcula autom\xe1ticamente los materiales requeridos"})]}),s.jsx(l.default,{href:"/",className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold",children:"â† Volver al Buscador"})]}),(0,s.jsxs)("div",{className:"bg-[#f8f9fa] p-5 rounded-lg border-2 border-[#e9ecef] mb-6",children:[s.jsx("div",{className:"text-xl font-bold text-[#495057] mb-4 flex items-center gap-2",children:"\uD83D\uDCCB Configuraci\xf3n de Torre"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-5",children:[s.jsx(n,{label:"TIPO:",value:e.tipo,options:t.TIPO,onChange:e=>y("tipo",e)}),s.jsx(n,{label:"FABRICANTE:",value:e.fabricante,options:t.FABRICANTE,onChange:e=>y("fabricante",e)}),s.jsx(n,{label:"CABEZA:",value:e.cabeza,options:t.CABEZA,onChange:e=>y("cabeza",e)})]}),s.jsx("div",{className:"text-xl font-bold text-[#495057] mb-4 mt-6 flex items-center gap-2",children:"\uD83D\uDDDDï¸ Selecciona las Partes de la Torre"}),j?s.jsx("p",{className:"text-center text-[#6c757d] italic p-5 bg-[#f8f9fa] rounded-lg",children:j}):s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Object.values(c).map(e=>s.jsx(i,{part:e,onToggle:()=>P(e.part),onQuantityChange:a=>C(e.part,a)},e.part))}),(0,s.jsxs)("div",{className:"flex gap-4 mt-5 flex-wrap",children:[s.jsx("button",{onClick:D,className:"bg-gradient-to-r from-[#667eea] to-[#764ba2] text-white px-8 py-3 rounded-lg font-semibold hover:shadow-lg transition",children:"\uD83E\uDDEE Calcular Materiales"}),s.jsx("button",{onClick:()=>{a({tipo:"",fabricante:"",cabeza:""}),d({}),x([]),b(!1),setTimeout(()=>N(),0)},className:"bg-[#6c757d] hover:bg-[#5a6268] text-white px-8 py-3 rounded-lg font-semibold transition",children:"\uD83D\uDD04 Limpiar"})]})]}),h&&(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4 p-4 bg-[#f8f9fa] rounded-lg",children:[s.jsx("div",{className:"font-bold text-[#495057]",children:g}),(0,s.jsxs)("div",{className:"flex gap-5 text-sm",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-[#6c757d] text-xs",children:"Total Piezas"}),s.jsx("span",{className:"font-bold text-[#667eea] text-xl",children:Math.round(u.total_pieces)})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[s.jsx("span",{className:"text-[#6c757d] text-xs",children:"Peso Total (kg)"}),s.jsx("span",{className:"font-bold text-[#667eea] text-xl",children:u.total_weight.toFixed(2)})]})]})]}),s.jsx("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto rounded-lg border-2 border-[#dee2e6]",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gradient-to-r from-[#667eea] to-[#764ba2] text-white sticky top-0 z-10",children:s.jsx("tr",{children:["Material","Descripci\xf3n","Parte","Posici\xf3n","Cant. Original","Cant. Calculada","Peso Unit. (kg)","Peso Total (kg)","Long 2"].map(e=>s.jsx("th",{className:"px-3 py-3 text-left font-semibold",children:e},e))})}),s.jsx("tbody",{children:p.map((e,a)=>(0,s.jsxs)("tr",{className:"border-b border-[#e9ecef] hover:bg-[#f8f9fa]",children:[s.jsx("td",{className:"px-3 py-2",children:e.id_item||"-"}),s.jsx("td",{className:"px-3 py-2",children:e.descripcion||"-"}),s.jsx("td",{className:"px-3 py-2",children:e.parte_division||"-"}),s.jsx("td",{className:"px-3 py-2",children:e.posicion||"-"}),s.jsx("td",{className:"px-3 py-2",children:e.cantidad_original}),s.jsx("td",{className:"px-3 py-2",children:s.jsx("span",{className:"bg-[#fff3cd] text-[#856404] font-bold px-2 py-1 rounded",children:e.cantidad_calculada})}),s.jsx("td",{className:"px-3 py-2",children:e.peso_unitario.toFixed(2)}),s.jsx("td",{className:"px-3 py-2",children:e.peso_total.toFixed(2)}),s.jsx("td",{className:"px-3 py-2",children:e.long_2_principal||"-"})]},a))})]})}),(0,s.jsxs)("div",{className:"mt-4 p-4 bg-[#e7f3ff] rounded-lg flex justify-between items-center",children:[s.jsx("span",{children:"\uD83D\uDCBE Exportar resultados para usar en tu proyecto"}),s.jsx("button",{onClick:()=>{if(0===p.length){_("âš ï¸ No hay datos para exportar");return}let e="Material,Descripci\xf3n,Parte,Posici\xf3n,Cant. Original,Cant. Calculada,Peso Unit.,Peso Total,Long 2\n";p.forEach(a=>{let t=[a.id_item||"-",a.descripcion||"-",a.parte_division||"-",a.posicion||"-",a.cantidad_original||0,a.cantidad_calculada||0,(a.peso_unitario||0).toFixed(2),(a.peso_total||0).toFixed(2),a.long_2_principal||"-"].map(e=>`"${e}"`).join(",");e+=t+"\n"});let a=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=`materiales_torre_${Date.now()}.csv`,s.click()},className:"bg-[#28a745] hover:bg-[#218838] text-white px-6 py-2 rounded-lg font-semibold",children:"\uD83D\uDCE5 Exportar a CSV"})]})]})]})})}function n({label:e,value:a,options:t,onChange:r}){return(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block font-semibold text-[#495057] mb-1 text-sm",children:e}),(0,s.jsxs)("select",{value:a,onChange:e=>r(e.target.value),className:"w-full p-2 border-2 border-[#dee2e6] rounded-md focus:border-[#667eea] focus:outline-none",children:[(0,s.jsxs)("option",{value:"",children:["Seleccionar ",e.replace(":","")]}),t.map(e=>s.jsx("option",{value:e,children:e},e))]})]})}function i({part:e,onToggle:a,onQuantityChange:t}){return(0,s.jsxs)("div",{onClick:a,className:`bg-white border-2 rounded-lg p-4 cursor-pointer transition hover:shadow-lg ${e.selected?"border-[#667eea] bg-[#f0f3ff]":"border-[#dee2e6]"}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("input",{type:"checkbox",checked:e.selected,onChange:a,className:"w-5 h-5",onClick:e=>e.stopPropagation()}),s.jsx("span",{className:"font-bold text-lg flex-1",children:e.part})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("label",{className:"text-sm text-[#495057]",children:"Cantidad:"}),s.jsx("input",{type:"number",min:"1",value:e.quantity,disabled:!e.selected,onChange:e=>t(parseInt(e.target.value)||1),onClick:e=>e.stopPropagation(),className:"w-20 p-1 border-2 border-[#dee2e6] rounded text-center font-bold disabled:opacity-50"})]})]})}},1676:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>s});let s=(0,t(8570).createProxy)(String.raw`D:\Transelca - Martin Pinedo\Proyecto-Desglose-de-Torres\app\calculadora\page.tsx#default`)},1506:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l,metadata:()=>r});var s=t(1159);t(7272);let r={title:"Desglose de Torres",description:"Sistema de b\xfasqueda y c\xe1lculo de materiales para torres"};function l({children:e}){return s.createElement("html",{lang:"es"},s.createElement("body",null,e))}},7272:()=>{}};var a=require("../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[276,471,434],()=>t(8805));module.exports=s})();